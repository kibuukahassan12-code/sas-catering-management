{% extends "base.html" %}
{% block content %}
<section class="page-header">
    <div>
        <p class="eyebrow">HR Department</p>
        <h1>{{ employee.full_name }}</h1>
        <p class="muted">{{ employee.position.title if employee.position else 'No Position' }} • {{ employee.department.name if employee.department else 'No Department' }}</p>
    </div>
    <div class="quick-links">
        <a class="btn-secondary" href="{{ url_for('hr.employee_list') }}">← Back to Employees</a>
    </div>
</section>

<!-- Employee Details -->
<section class="panel">
    <div style="display: flex; gap: 2rem; padding: 1.5rem;">
        <div>
            {% if employee.photo_url %}
            <img src="{{ url_for('static', filename=employee.photo_url) }}" alt="{{ employee.full_name }}" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 3px solid #e9ecef;">
            {% else %}
            <div style="width: 150px; height: 150px; border-radius: 50%; background: #e9ecef; display: flex; align-items: center; justify-content: center; font-size: 3rem; font-weight: bold; color: #6c757d;">{{ employee.first_name[0] }}{{ employee.last_name[0] }}</div>
            {% endif %}
        </div>
        <div style="flex: 1;">
            <h2>{{ employee.full_name }}</h2>
            <div class="summary-grid" style="grid-template-columns: repeat(2, 1fr); margin-top: 1rem;">
                <div>
                    <strong>Email:</strong> {{ employee.email }}
                </div>
                <div>
                    <strong>Phone:</strong> {{ employee.phone or 'N/A' }}
                </div>
                <div>
                    <strong>Position:</strong> {{ employee.position.title if employee.position else 'N/A' }}
                </div>
                <div>
                    <strong>Department:</strong> {{ employee.department.name if employee.department else 'N/A' }}
                </div>
                <div>
                    <strong>Hire Date:</strong> {{ employee.hire_date.strftime('%Y-%m-%d') if employee.hire_date else 'N/A' }}
                </div>
                <div>
                    <strong>Contract Type:</strong> {{ employee.contract_type or 'N/A' }}
                </div>
                <div>
                    <strong>Status:</strong> 
                    {% if employee.status == 'active' %}
                    <span class="badge success">Active</span>
                    {% else %}
                    <span class="badge">{{ employee.status }}</span>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Attendance History -->
{% if attendances %}
<section class="panel">
    <div class="panel-header">
        <h3>Recent Attendance</h3>
    </div>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Clock In</th>
                    <th>Clock Out</th>
                    <th>Hours Worked</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for attendance in attendances %}
                <tr>
                    <td>{{ attendance.clock_in.strftime('%Y-%m-%d') if attendance.clock_in else 'N/A' }}</td>
                    <td>{{ attendance.clock_in.strftime('%H:%M') if attendance.clock_in else 'N/A' }}</td>
                    <td>{{ attendance.clock_out.strftime('%H:%M') if attendance.clock_out else 'N/A' }}</td>
                    <td>{{ "%.2f"|format(attendance.hours_worked) if attendance.hours_worked else 'N/A' }} hrs</td>
                    <td>
                        {% if attendance.approved %}
                        <span class="badge success">Approved</span>
                        {% else %}
                        <span class="badge">Pending</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endif %}

<!-- Leave Requests -->
{% if leave_requests %}
<section class="panel">
    <div class="panel-header">
        <h3>Leave Requests</h3>
    </div>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Leave Type</th>
                    <th>Start Date</th>
                    <th>End Date</th>
                    <th>Days</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for leave in leave_requests %}
                <tr>
                    <td>{{ leave.leave_type }}</td>
                    <td>{{ leave.start_date.strftime('%Y-%m-%d') if leave.start_date else 'N/A' }}</td>
                    <td>{{ leave.end_date.strftime('%Y-%m-%d') if leave.end_date else 'N/A' }}</td>
                    <td>{{ leave.days_requested }} days</td>
                    <td>
                        {% if leave.status == 'approved' %}
                        <span class="badge success">Approved</span>
                        {% elif leave.status == 'rejected' %}
                        <span class="badge danger">Rejected</span>
                        {% else %}
                        <span class="badge warning">Pending</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endif %}

<!-- Shift Assignments -->
{% if shift_assignments %}
<section class="panel">
    <div class="panel-header">
        <h3>Shift Assignments</h3>
    </div>
    <div class="table-wrapper">
        <table>
            <thead>
                <tr>
                    <th>Date</th>
                    <th>Shift</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for assignment in shift_assignments %}
                <tr>
                    <td>{{ assignment.date.strftime('%Y-%m-%d') if assignment.date else 'N/A' }}</td>
                    <td>{{ assignment.shift.name if assignment.shift else 'N/A' }}</td>
                    <td><span class="badge">{{ assignment.status }}</span></td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endif %}

{% endblock %}


