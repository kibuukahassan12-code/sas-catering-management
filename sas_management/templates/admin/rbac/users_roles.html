{% extends "base.html" %}
{% block content %}
<section class="page-header">
    <div>
        <p class="eyebrow">Admin · RBAC</p>
        <h1>Assign Roles to Users</h1>
        <p class="muted">Assign roles to users to control their access permissions.</p>
    </div>
    <a class="btn-secondary" href="{{ url_for('rbac.roles_list') }}">← Back to Roles</a>
</section>

<section class="panel">
    <form method="POST">
        <div class="form-group">
            <label for="user_id">User *</label>
            <select name="user_id" id="user_id" class="form-control" required>
                <option value="">— Select User —</option>
                {% for user in users %}
                <option value="{{ user.id }}">{{ user.email }}</option>
                {% endfor %}
            </select>
        </div>

        <div class="form-group">
            <label for="role_id">Role *</label>
            <select name="role_id" id="role_id" class="form-control" required>
                <option value="">— Select Role —</option>
                {% for role in roles %}
                <option value="{{ role.id }}">{{ role.name }}</option>
                {% endfor %}
            </select>
        </div>

        <div style="display: flex; gap: 1rem; margin-top: 1.5rem;">
            <button type="submit" class="btn-primary">Assign Role</button>
            <a href="{{ url_for('rbac.roles_list') }}" class="btn-secondary">Cancel</a>
        </div>
    </form>
</section>

<section class="panel">
    <div class="panel-header">
        <h3>Current User-Role Assignments</h3>
    </div>
    <div class="table-wrapper table-responsive">
        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Assigned Role</th>
                </tr>
            </thead>
            <tbody>
                {% for user in users %}
                {% if user.role_obj %}
                <tr>
                    <td><strong>{{ user.email }}</strong></td>
                    <td><span class="badge">{{ user.get_role_name() }}</span></td>
                </tr>
                {% endif %}
                {% endfor %}
            </tbody>
        </table>
    </div>
</section>
{% endblock %}

